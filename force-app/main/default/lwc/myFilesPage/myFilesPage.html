<template>
    <div class="container">
        <h1>File Upload</h1>

        <div>
            <lightning-input
                type="file"
                name="fileUploader"
                label="Pick file to upload"
                multiple="true"
                accept="*/*"
                onchange={handleInputChange}
            >
            </lightning-input>
        </div>

        <!-- Currently komaci only supports the if:true= instead of the new lds:if directive -->
        <div if:true={fileName}>
            <p>Selected file:</p>
            <p>{fileName}</p>
            <div class="inputs">
                <lightning-input
                    type="text"
                    label="Title"
                    value={titleValue}
                    onchange={handleTitleInputChange}
                ></lightning-input>
                <lightning-input
                    type="text"
                    label="Description"
                    value={descriptionValue}
                    onchange={handleDescriptionInputChange}
                ></lightning-input>
            </div>
            <button
                class="slds-button slds-button_brand slds-var-m-top_medium"
                disabled={uploadingFile}
                onclick={handleUploadClick}
            >
                Upload
            </button>
        </div>

        <!-- Currently komaci only supports the if:true= instead of the new lds:if directive -->
        <div if:true={errorMessage}>
            <lightning-card title="Error">
                <div class="card-body">{errorMessage}</div>
            </lightning-card>
        </div>
        <hr />

        <!-- Check if there are any files to display -->
        <!-- Currently komaci only supports the if:true= instead of the new lds:if directive -->
        <template if:true={relatedFileData}>
            <div class="slds-var-m-around_medium">
                <!-- Iterate across each file -->
                <template for:each={relatedFileData} for:item="rec">
                    <div key={rec.fields.ContentDocumentId.value}>
                        <!-- Show the imageDetail LWC which will render the actual file-->
                        <c-image-detail recordfield={rec.fields.ContentDocumentId.value}></c-image-detail>
                    </div>
                </template>
            </div>
        </template>
        <!-- An else statement here can be used to show content if there are no images -->
    </div>
</template>
